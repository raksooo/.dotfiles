#!/usr/bin/env sh

getProcesses() {
    PROCESSES=$(ps -u $1 | grep -v "PID")
    if [[ $2 ]]; then
        EXCEPT="i3lock\|$2"
        PROCESSES=$(echo "$PROCESSES" | grep -v $EXCEPT)
    fi
    echo "$PROCESSES" | awk '{print $1}'
}

if [[ $1 ]]; then
    case "$1" in
        suspend)

            getProcesses $2 $3 | xargs kill -TSTP
            ;;
        resume)
            getProcesses $2 $3 | xargs kill -CONT
            ;;
    esac
else
    echo "Usage: suspendUser <suspend|resume> user [exceptions]"
fi
